<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.361">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Engle Lab useRguide - 9&nbsp; Working with Data</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./data-processing-steps.html" rel="next">
<link href="./import-write.html" rel="prev">
<link href="./cover.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
</head>
<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg navbar-dark "><div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Engle Lab useRguide</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item">
    <a class="nav-link" href="https://englelab.gatech.edu/" rel="" target="_blank">
 <span class="menu-text">Lab Website</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://engle-lab.gitbook.io/lab-manual/" rel="" target="_blank">
 <span class="menu-text">Lab Manual</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-r-packages" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">R Packages</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-r-packages">
<li>
    <a class="dropdown-item" href="https://englelab.github.io/englelab/" rel="" target="_blank">
 <span class="dropdown-text">englelab</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://dr-jt.github.io/psyworkflow/" rel="" target="_blank">
 <span class="dropdown-text">psyworkflow</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://dr-jt.github.io/semoutput/" rel="" target="_blank">
 <span class="dropdown-text">semoutput</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://dr-jt.github.io/modeloutput/" rel="" target="_blank">
 <span class="dropdown-text">modeloutput</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://dr-jt.github.io/pupillometry/" rel="" target="_blank">
 <span class="dropdown-text">pupillometry</span></a>
  </li>  
    </ul>
</li>
</ul>
<div class="quarto-navbar-tools ms-auto">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./this-is-the-way.html">Tidyverse</a></li><li class="breadcrumb-item"><a href="./working-with-data.html"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Working with Data</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto"><div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Getting Started</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./installation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Installs and Updates</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pkgs-and-funcs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Functions and Packages</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./R-basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">R Basics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./R-intermediate.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">R Intermediate</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./quarto-rmarkdown-basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Quarto Basics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tips.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Useful Tips</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Tidyverse</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./this-is-the-way.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">This is the Way</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./import-write.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Import and Export Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./working-with-data.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Working with Data</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Data Processing</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-processing-steps.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Data Processing Steps</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tidy-raw-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Tidy Raw Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./score-clean-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Score and Clean Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./single-merged-file.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Single Merged File</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">Data Visualization</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro-ggplot2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Intro to ggplot2</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./reproducible-workflow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Reproducible Workflow</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./file-organization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">File Organization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./psyworkflow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">psyworkflow</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#sec-dplyr" id="toc-sec-dplyr" class="nav-link active" data-scroll-target="#sec-dplyr">dplyr</a></li>
  <li><a href="#sec-stay-within-the-data-frame" id="toc-sec-stay-within-the-data-frame" class="nav-link" data-scroll-target="#sec-stay-within-the-data-frame">Stay within the Data Frame</a></li>
  <li>
<a href="#setup-r-script" id="toc-setup-r-script" class="nav-link" data-scroll-target="#setup-r-script">Setup R Script</a>
  <ul class="collapse">
<li><a href="#setup" id="toc-setup" class="nav-link" data-scroll-target="#setup">Setup</a></li>
  <li><a href="#import" id="toc-import" class="nav-link" data-scroll-target="#import">Import</a></li>
  </ul>
</li>
  <li><a href="#sec-rename" id="toc-sec-rename" class="nav-link" data-scroll-target="#sec-rename">rename()</a></li>
  <li><a href="#sec-filter" id="toc-sec-filter" class="nav-link" data-scroll-target="#sec-filter">filter()</a></li>
  <li><a href="#sec-select" id="toc-sec-select" class="nav-link" data-scroll-target="#sec-select">select()</a></li>
  <li>
<a href="#sec-mutate" id="toc-sec-mutate" class="nav-link" data-scroll-target="#sec-mutate">mutate()</a>
  <ul class="collapse">
<li><a href="#sec-changing-values-in-an-existing-column" id="toc-sec-changing-values-in-an-existing-column" class="nav-link" data-scroll-target="#sec-changing-values-in-an-existing-column">Changing values in an existing column</a></li>
  <li><a href="#sec-creating-a-new-column" id="toc-sec-creating-a-new-column" class="nav-link" data-scroll-target="#sec-creating-a-new-column">Creating a new column</a></li>
  </ul>
</li>
  <li><a href="#sec-case_when" id="toc-sec-case_when" class="nav-link" data-scroll-target="#sec-case_when">case_when()</a></li>
  <li><a href="#group_by" id="toc-group_by" class="nav-link" data-scroll-target="#group_by">group_by()</a></li>
  <li><a href="#by-vs.-group_by" id="toc-by-vs.-group_by" class="nav-link" data-scroll-target="#by-vs.-group_by">.by vs.&nbsp;group_by()</a></li>
  <li><a href="#sec-summarise" id="toc-sec-summarise" class="nav-link" data-scroll-target="#sec-summarise">summarise()</a></li>
  <li><a href="#sec-pivot_wider" id="toc-sec-pivot_wider" class="nav-link" data-scroll-target="#sec-pivot_wider">pivot_wider()</a></li>
  <li><a href="#sec-pivot_longer" id="toc-sec-pivot_longer" class="nav-link" data-scroll-target="#sec-pivot_longer">pivot_longer()</a></li>
  <li><a href="#all-together-now" id="toc-all-together-now" class="nav-link" data-scroll-target="#all-together-now">All Together Now</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title"><span id="sec-working-with-data" class="quarto-section-identifier"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Working with Data</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><p>For this Chapter we will use an example data set from the <em>Flanker</em> task. This data set is a <em>tidy</em> raw data file for over 100 subjects on the <em>Flanker</em> task. There is one row per <code>Trial</code> per <code>Subject</code> and there is <code>RT</code> and <code>Accuracy</code> data on each <code>Trial</code>. Each <code>Trial</code> is either <code>congruent</code> or <code>incongruent</code>.</p>
<p>What we will want to do is calculate a <code>FlankerEffect</code> for each <code>Subject</code> so that we end up with one score for each <code>Subject</code>.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p><a href="http://englelab.gatech.edu/useRguide/tidyverse_example.zip">Download Example Date Set</a></p>
</div>
</div>
<p>Install the <code>dplyr</code> and <code>tidyr</code> packages</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"dplyr"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"tidyr"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="sec-dplyr" class="level2"><h2 class="anchored" data-anchor-id="sec-dplyr">dplyr</h2>
<p>The language of <code>dplyr</code> will be the underlying framework for how you will think about manipulating a <code>dataframe</code>.</p>
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div id="fig-dplyr-logo" class="quarto-figure quarto-figure-left anchored">
<figure class="figure"><p><img src="images/dplyr_logo.png" class="img-fluid figure-img" style="width:25.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;9.1: dplyr logo</figcaption></figure>
</div>
</div>
</div>
<p><code>dplyr</code> uses intuitive language that you are already familiar with. As with any R function, you can think of functions in the dplyr package as verbs that refer to performing a particular action on a data frame. The core dplyr functions are:</p>
<ul>
<li><p><code><a href="https://dplyr.tidyverse.org/reference/rename.html">rename()</a></code> renames columns</p></li>
<li><p><code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a></code> filters rows based on their values in specified columns</p></li>
<li><p><code><a href="https://dplyr.tidyverse.org/reference/select.html">select()</a></code> selects (or removes) columns</p></li>
<li><p><code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> creates new columns based on transformation from other columns, or edits values within existing columns</p></li>
<li><p><code><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by()</a></code> splits data frame into separate groups based on specified columns</p></li>
<li><p><code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise()</a></code> aggregates across rows to create a summary statistic (means, standard deviations, etc.)</p></li>
</ul>
<p>For more information on these functions <a href="https://dplyr.tidyverse.org" target="_blank">Visit the dplyr webpage</a></p>
<p>For more detailed instructions on how to use the <code>dplyr</code> functions see the <a href="https://r4ds.had.co.nz/transform.html" target="_blank">Data Transformation</a> chapter in the popular <a href="https://r4ds.had.co.nz/index.html" target="_blank">R for Data Science</a> book.</p>
</section><section id="sec-stay-within-the-data-frame" class="level2"><h2 class="anchored" data-anchor-id="sec-stay-within-the-data-frame">Stay within the Data Frame</h2>
<p>Not only is the language of <code>dplyr</code> intuitive but it allows you to perform data manipulations all within the <code>dataframe</code> itself, without having to create external variables, lists, for loops, etc.</p>
<p>It can be tempting to hold information outside of a data frame but in general I suggest avoiding this strategy. Instead, hold the information in a new column within the <code>data frame</code> itself.</p>
<p>For example: A common strategy I see any many R scripts is to hold the mean or count of a column of values outside the <code>dataframe</code> and in a new variable in the Environment.</p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">6</span>,<span class="fl">4</span>,<span class="fl">3</span>,<span class="fl">7</span>,<span class="fl">5</span>,<span class="fl">8</span>,<span class="fl">4</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">4</span>,<span class="fl">6</span>,<span class="fl">4</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">y_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">y</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This variable then could be used to subtract out the mean from the values in column <code>y</code></p>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'dplyr'</span></span>
<span><span class="co">## The following objects are masked from 'package:stats':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     filter, lag</span></span>
<span><span class="co">## The following objects are masked from 'package:base':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     intersect, setdiff, setequal, union</span></span>
<span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="va">data</span>, </span>
<span>               y_new <span class="op">=</span> <span class="va">y</span> <span class="op">-</span> <span class="va">y_mean</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">##   x y  y_new</span></span>
<span><span class="co">## 1 1 2 -1.125</span></span>
<span><span class="co">## 2 6 3 -0.125</span></span>
<span><span class="co">## 3 4 2 -1.125</span></span>
<span><span class="co">## 4 3 1 -2.125</span></span>
<span><span class="co">## 5 7 4  0.875</span></span>
<span><span class="co">## 6 5 6  2.875</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Although there is nothing wrong with this approach, in general, I would advise against this strategy. A better strategy is to do all this without leaving the data frame <code>data</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">6</span>,<span class="fl">4</span>,<span class="fl">3</span>,<span class="fl">7</span>,<span class="fl">5</span>,<span class="fl">8</span>,<span class="fl">4</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">4</span>,<span class="fl">6</span>,<span class="fl">4</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="va">data</span>,</span>
<span>               y_mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>,</span>
<span>               y_new <span class="op">=</span> <span class="va">y</span> <span class="op">-</span> <span class="va">y_mean</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">##   x y y_mean  y_new</span></span>
<span><span class="co">## 1 1 2  3.125 -1.125</span></span>
<span><span class="co">## 2 6 3  3.125 -0.125</span></span>
<span><span class="co">## 3 4 2  3.125 -1.125</span></span>
<span><span class="co">## 4 3 1  3.125 -2.125</span></span>
<span><span class="co">## 5 7 4  3.125  0.875</span></span>
<span><span class="co">## 6 5 6  3.125  2.875</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>It can be tempting to also think about writing for loops in your R script, but honestly for the most part for loops are avoidable thanks to a dplyr function called <code><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by()</a></code>.</p>
<p>The only time I end up needing a for loop is when creating code to put into a function.</p>
</section><section id="setup-r-script" class="level2"><h2 class="anchored" data-anchor-id="setup-r-script">Setup R Script</h2>
<section id="setup" class="level3"><h3 class="anchored" data-anchor-id="setup">Setup</h3>
<p>At the top of your script load the three packages you will need for this Chapter</p>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Setup</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://readr.tidyverse.org">readr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org">tidyr</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Notice how I added a <em>commented</em> line at the top. Adding <em>comments</em> to your scripts is highly advisable, as it will help you understand your scripts when you come back to them after not working on them for a while.</p>
</section><section id="import" class="level3"><h3 class="anchored" data-anchor-id="import">Import</h3>
<p>Import the data file you downloaded. Refer to <a href="import-write.html"><span>Chapter&nbsp;8</span></a> for how to do this.</p>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">import</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"data/tidyverse_example.csv"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>It is always a good idea to get to know your <code>dataframe</code> before you start messing with it. What are the column names? What kind of values are stored in each column? How many observations are there? How many <code>Subjects</code>? How many <code>Trials</code>? etc.</p>
<p>What are the column names? use <code><a href="https://rdrr.io/r/base/colnames.html">colnames()</a></code> for a quick glance at the column names</p>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">import</span><span class="op">)</span></span>
<span><span class="co">##  [1] "Subject"              "TrialProc"            "Trial"               </span></span>
<span><span class="co">##  [4] "Condition"            "RT"                   "ACC"                 </span></span>
<span><span class="co">##  [7] "Response"             "TargetArrowDirection" "SessionDate"         </span></span>
<span><span class="co">## [10] "SessionTime"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To take a quick look at the first few rows of a <code>dataframe</code> use <code><a href="https://rdrr.io/r/utils/head.html">head()</a></code>.</p>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">import</span><span class="op">)</span></span>
<span><span class="co">## # A tibble: 6 × 10</span></span>
<span><span class="co">##   Subject TrialProc Trial Condition      RT   ACC Response</span></span>
<span><span class="co">##     &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;   </span></span>
<span><span class="co">## 1   14000 practice      1 incongruent  1086     1 left    </span></span>
<span><span class="co">## 2   14000 practice      2 incongruent   863     1 left    </span></span>
<span><span class="co">## 3   14000 practice      3 congruent     488     1 right   </span></span>
<span><span class="co">## 4   14000 practice      4 incongruent   588     1 right   </span></span>
<span><span class="co">## 5   14000 practice      5 congruent     581     1 right   </span></span>
<span><span class="co">## 6   14000 practice      6 incongruent   544     1 right   </span></span>
<span><span class="co">## # ℹ 3 more variables: TargetArrowDirection &lt;chr&gt;, SessionDate &lt;chr&gt;,</span></span>
<span><span class="co">## #   SessionTime &lt;time&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This gives you a good idea of what column names you will be working with and what kind of values they contain.</p>
<p>To evaluate what are all the unique values in a column you can use <code><a href="https://rdrr.io/r/base/unique.html">unique()</a></code>. You can also use this in combination with <code><a href="https://rdrr.io/r/base/length.html">length()</a></code> to evaluate how many unique values are in a column.</p>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">import</span><span class="op">$</span><span class="va">Condition</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "incongruent" "congruent"  </code></pre>
</div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">import</span><span class="op">$</span><span class="va">Trial</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1]   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17  18
 [19]  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35  36
 [37]  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53  54
 [55]  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71  72
 [73]  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89  90
 [91]  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107 108
[109] 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126
[127] 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144
[145] 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162
[163] 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180
[181] 181 182 183 184 185 186 187 188 189 190 191 192</code></pre>
</div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">import</span><span class="op">$</span><span class="va">Trial</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 192</code></pre>
</div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">import</span><span class="op">$</span><span class="va">Subject</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 410</code></pre>
</div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">import</span><span class="op">$</span><span class="va">TrialProc</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "practice" "real"    </code></pre>
</div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">import</span><span class="op">$</span><span class="va">ACC</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 0</code></pre>
</div>
</div>
<p>All these functions we just used from <code><a href="https://rdrr.io/r/base/colnames.html">colnames()</a></code> to <code><a href="https://rdrr.io/r/base/unique.html">unique()</a></code> were to temporarily evaluate our data. They are not required to perform the actual data analysis. Therefore, I usually just type these in the console. A general rule of thumb is that if it is not required to be saved in your Script file then just type it in the console.</p>
<hr>
<p>Okay let’s take a look at how to use the <code>dplyr</code> functions to score this data.</p>
</section></section><section id="sec-rename" class="level2"><h2 class="anchored" data-anchor-id="sec-rename">rename()</h2>
<p>We do not really need to, but let’s go ahead and <code><a href="https://dplyr.tidyverse.org/reference/rename.html">rename()</a></code> a column. How about instead of <code>ACC</code> let’s label it as <code>Accuracy</code>. Pretty simple</p>
<div class="cell">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span><span class="va">import</span>, Accuracy <span class="op">=</span> <span class="va">ACC</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code><a href="https://dplyr.tidyverse.org/reference/rename.html">rename()</a></code> is really only useful if you are not also using <code><a href="https://dplyr.tidyverse.org/reference/select.html">select()</a></code> or <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code>. In <code><a href="https://dplyr.tidyverse.org/reference/select.html">select()</a></code> you can also rename columns as you select them to keep. This will be illustrated this later</p>
<p>Notice that I passed the output of this function to a new object <code>data</code>. I like to keep the object <code>import</code> as the original imported file and any changes will be passed onto a new data frame, such as <code>data</code>. This makes it easy to go back and see what the original data is. Because if we were to overwrite <code>import</code> then we would have to execute the <code><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv()</a></code> import function again to be able to see the original data file, just a little more tedious.</p>
</section><section id="sec-filter" class="level2"><h2 class="anchored" data-anchor-id="sec-filter">filter()</h2>
<p><code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a></code> is an inclusive filter and requires the use of <em>logical</em> statements. In <strong>Chapter 2: Basic R</strong> I talked a little bit about logical statements. <a href="R-basics.html#fig-logical-operators">Figure&nbsp;<span>3.1</span></a> shows a list of logical operators in R.</p>
<p>In addition to the logical operators, other functions can be used in <code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a></code>, such as:</p>
<ul>
<li><p><code><a href="https://rdrr.io/r/base/NA.html">is.na()</a></code> - include if missing</p></li>
<li><p><code>!is.na()</code> - include if not missing</p></li>
<li><p><code><a href="https://dplyr.tidyverse.org/reference/between.html">between()</a></code> - values that are between a certain range of numbers</p></li>
<li><p><code><a href="https://dplyr.tidyverse.org/reference/near.html">near()</a></code> - values that are near a certain value</p></li>
</ul>
<p>We do not want to include practice trials when calculating the mean on RTs. We will use <code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a></code> to remove these rows. First let’s evaluate the values in these columns</p>
<div class="cell">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">import</span><span class="op">$</span><span class="va">TrialProc</span><span class="op">)</span></span>
<span><span class="co">## [1] "practice" "real"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">import</span><span class="op">$</span><span class="va">Condition</span><span class="op">)</span></span>
<span><span class="co">## [1] "incongruent" "congruent"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can specify our <code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a></code> in a couple of different ways</p>
<div class="cell">
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">data</span>, </span>
<span>               <span class="va">TrialProc</span> <span class="op">!=</span> <span class="st">"practice"</span>, </span>
<span>               <span class="va">Condition</span> <span class="op">!=</span> <span class="st">"neutral"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>or</p>
<div class="cell">
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">import</span>, </span>
<span>               <span class="va">TrialProc</span> <span class="op">==</span> <span class="st">"real"</span>, </span>
<span>               <span class="va">Condition</span> <span class="op">==</span> <span class="st">"congruent"</span> <span class="op">|</span> <span class="va">Condition</span> <span class="op">==</span> <span class="st">"incongruent"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Specifying multiple arguments separated by a comma <code>,</code> in <code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a></code> is equivalent to an <code>&amp;</code> (<code>and</code>) statement.</p>
<p>In the second option, since there are two types of rows on <code>Condition</code> that we want to keep we need to specify <code>Condition ==</code> twice, separated by <code>|</code> (<code>or</code>). We want to keep rows where <code>Condition == "congruent"</code> <code>or</code> <code>Condition == "incongruent"</code></p>
<p>Notice that the arguments have been separated on different lines. This is okay to do and makes it easier to read the code. Just make sure the end of the line still has a comma.</p>
<p>Go ahead and view <code>data</code>. Did it properly remove <code>practice</code> trials? How about <code>neutral</code> trials?</p>
<div class="cell">
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">TrialProc</span><span class="op">)</span></span>
<span><span class="co">## [1] "real"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">Condition</span><span class="op">)</span></span>
<span><span class="co">## [1] "incongruent" "congruent"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Again you should type these in the console NOT in the R Script!</strong></p>
<p>There is a lot of consistency of how you specify arguments in the dplyr package.</p>
<ol type="1">
<li><p>You always first specify the data frame that the function is being performed on, followed by the arguments for that function.</p></li>
<li><p>Column names can be called just like regular R objects, that is without putting the column name in <code>" "</code> like you do with strings. If all you know is dplyr, then this might not seem like anything special but it is. Most non-tidyverse functions will require you to put <code>" "</code> around column names.</p></li>
</ol></section><section id="sec-select" class="level2"><h2 class="anchored" data-anchor-id="sec-select">select()</h2>
<p><code><a href="https://dplyr.tidyverse.org/reference/select.html">select()</a></code> allows you to select which columns to keep and/or remove.</p>
<p>Let’s keep <code>Subject</code>, <code>Condition</code>, <code>RT</code>, <code>Trial</code>, and <code>Accuracy</code> and remove <code>TrialProc</code>, <code>TargetArrowDirection</code>, <code>SessionDate</code>, and <code>SessionTime</code>.</p>
<p><code><a href="https://dplyr.tidyverse.org/reference/select.html">select()</a></code> is actually quite versatile - you can remove columns by specifying certain patterns. I will only cover a couple here, but to learn more <a href="https://dplyr.tidyverse.org/reference/select.html" target="_blank">Visit the select() webpage</a></p>
<p>We could just simply select all the columns we want to keep</p>
<div class="cell">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">Subject</span>, <span class="va">Condition</span>, <span class="va">RT</span>, <span class="va">Trial</span>, <span class="va">Accuracy</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>alternatively we can specify which columns we want to remove by placing a <code>-</code> in front of the columns</p>
<div class="cell">
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">data</span>, <span class="op">-</span><span class="va">TrialProc</span>, <span class="op">-</span><span class="va">TargetArrowDirection</span>, </span>
<span>               <span class="op">-</span><span class="va">SessionDate</span>, <span class="op">-</span><span class="va">SessionTime</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>or we can remove (or keep) columns based on a pattern. For instance <code>SessionDate</code> and <code>SessionTime</code> both start with <code>Session</code></p>
<div class="cell">
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">data</span>, <span class="op">-</span><span class="va">TrialProc</span>, <span class="op">-</span><span class="va">TargetArrowDirection</span>, </span>
<span>               <span class="op">-</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">starts_with</a></span><span class="op">(</span><span class="st">"Session"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You might start realizing that there is always more than one way to perform the same operation. It is good to be aware of all the ways you can use a function because there might be certain scenarios where it is better or even required to use one method over another. In this example, you only need to know the most straightforward method of simply selecting which columns to keep.</p>
<p>You can also rename variables as you <code><a href="https://dplyr.tidyverse.org/reference/select.html">select()</a></code> them… let’s change <code>Accuracy</code> back to <code>ACC</code>… just because we are crazy!</p>
<div class="cell">
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">Subject</span>, <span class="va">Condition</span>, <span class="va">RT</span>, <span class="va">Trial</span>, ACC <span class="op">=</span> <span class="va">Accuracy</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We are keeping <code>Subject</code>, <code>Condition</code>, <code>RT</code>, <code>Trial</code>, and renaming <code>ACC</code> to <code>Accuracy</code>.</p>
</section><section id="sec-mutate" class="level2"><h2 class="anchored" data-anchor-id="sec-mutate">mutate()</h2>
<p><code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> is a very powerful function. It basically allows you to do any computation or transformation on the values in the data frame. You can</p>
<ol type="1">
<li><p>change the values in already existing columns</p></li>
<li><p>create new columns based on transformation of other columns</p></li>
</ol>
<section id="sec-changing-values-in-an-existing-column" class="level3"><h3 class="anchored" data-anchor-id="sec-changing-values-in-an-existing-column">Changing values in an existing column</h3>
<p>Reaction times that are less than 200 milliseconds most likely do not reflect actual processing of the task. Therefore, it would be a good idea to not include these when calculating means.</p>
<p>What we are going to do is is set any RTs that are less than <code>200</code> milliseconds to missing, <code>NA</code>. First let’s make sure we even have trials that are less than <code>200</code> milliseconds. Two ways to do this. 1) View the data frame and click on the <code>RT</code> column to sort by RT. You can see there are RTs that are as small as 1 millisecond! Oh my, that is definitely not a real reaction time. 2) you can just evaluate the minimum value in the RT column:</p>
<div class="cell">
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">RT</span><span class="op">)</span></span>
<span><span class="co">## [1] 0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now lets <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code></p>
<div class="cell">
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="va">data</span>, RT <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">RT</span> <span class="op">&lt;</span> <span class="fl">200</span>, <span class="cn">NA</span>, <span class="va">RT</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Since we are replacing values in an already existing column we can just specify that column name, <code>RT =</code> followed by the transformation. Here we need to specify an if…then… else statement. To do so within the <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> function we use the function called <code><a href="https://rdrr.io/r/base/ifelse.html">ifelse()</a></code>.</p>
<p><code><a href="https://rdrr.io/r/base/ifelse.html">ifelse()</a></code> evaluates a logical statement specified in the first argument, <code>RT &lt; 200</code>. <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> works on a row-by-row basis. So for each row it will evaluate whether <code>RT</code> is less than 200. If this logical statement is <code>TRUE</code> then it will perform the next argument, in this case sets <code>RT = NA</code>. If the logical statement is <code>FALSE</code> then it will perform the last argument, in this case sets <code>RT = RT</code> (leaves the value unchanged).</p>
</section><section id="sec-creating-a-new-column" class="level3"><h3 class="anchored" data-anchor-id="sec-creating-a-new-column">Creating a new column</h3>
<p>Let’s say for whatever reason we want to calculate the difference between the RT on a trial minus the overall grand mean RT (for now, across all subjects and all trials). This is not necessary for what we want in the end but what the heck, let’s be a little crazy. (I just need a good example to illustrate what <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> can do.)</p>
<p>So first we will want to calculate a “grand” mean RT. We can use the <code><a href="https://rdrr.io/r/base/mean.html">mean()</a></code> function to calculate a mean.</p>
<div class="cell">
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">RT</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">## [1] 529.1414</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Since we replaced some of the <code>RT</code> values with <code>NA</code> we need to make sure we specify in the <code><a href="https://rdrr.io/r/base/mean.html">mean()</a></code> function to remove <code>NAs</code> by setting <code>na.rm = TRUE</code>.</p>
<p>We can use the <code><a href="https://rdrr.io/r/base/mean.html">mean()</a></code> function inside of a <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> function. Let’s put this “grand” mean in a column labeled <code>grandRT</code>.</p>
<p>First take note of how many columns there are in <code>data</code></p>
<div class="cell">
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">## [1] 5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>So after calculating the grandRT we should expect there to be one additional column for a total of 6 columns</p>
<div class="cell">
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="va">data</span>, grandRT <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">RT</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Cool!</p>
<p>Now let’s calculate another column that is the difference between <code>RT</code> and <code>grandRT</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="va">data</span>, RTdiff <span class="op">=</span> <span class="va">RT</span> <span class="op">-</span> <span class="va">grandRT</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can put all these <code>mutate()s</code> into one <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code></p>
<div class="cell">
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="va">data</span>, </span>
<span>               RT <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">RT</span> <span class="op">&lt;</span> <span class="fl">200</span>, <span class="cn">NA</span>, <span class="va">RT</span><span class="op">)</span>,</span>
<span>               grandRT <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">RT</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>               RTdiff <span class="op">=</span> <span class="va">RT</span> <span class="op">-</span> <span class="va">grandRT</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Notice how I put each one on a separate line. This is just for ease of reading and so the line doesn’t extend too far off the page. Just make sure the commas are still there at the end of each line.</p>
</section></section><section id="sec-case_when" class="level2"><h2 class="anchored" data-anchor-id="sec-case_when">case_when()</h2>
<p>Often times you will want to <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> values conditionally based on values in other columns. There are two functions that will help you do this, <code><a href="https://rdrr.io/r/base/ifelse.html">ifelse()</a></code> and <code><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when()</a></code>. <code><a href="https://rdrr.io/r/base/ifelse.html">ifelse()</a></code> is a base R function and <code><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when()</a></code> is a dplyr function.</p>
<p><code><a href="https://rdrr.io/r/base/ifelse.html">ifelse()</a></code> takes the format: <code>ifelse(conditional argument, value if TRUE, value if FALSE)</code></p>
<p>As an example, lets say we want to code a new variable that indicates whether the reaction time on a trial met a certain response deadline or not. Let’s call this column <code>Met_ResponseDeadline</code> and give a value of <code>1</code> to trials that met the deadline and <code>0</code> to trials that did not meet the deadline. Let’s set the response deadline at a reaction time of <code>500</code> milliseconds.</p>
<p>The conditional argument will take the form: <code>RT</code> is less than or equal to 500. If this statement is <code>TRUE</code>, then we will assign a value of <code>1</code> to the column <code>Met_ResponseDeadline</code>. If this statement is <code>FALSE</code>, then we will assign a value of <code>0</code> to the column <code>Met_ResponseDeadline</code>.</p>
<p>The code looks like:</p>
<div class="cell">
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">import</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Met_ResponseDeadline <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">RT</span> <span class="op">&lt;=</span> <span class="fl">500</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Check out <code>data</code> to make sure it worked.</p>
<p>You can even combine multiple <code><a href="https://rdrr.io/r/base/ifelse.html">ifelse()</a></code> statements into one. Let’s say we actually want to recode the column <code>ACC</code> to reflect not just correct and incorrect response but also whether they met the response deadline or not. That is, a value of <code>1</code> will represent responses that were correct AND met the response deadline and values of <code>0</code> represent responses that were either incorrect, did not meet the response deadline, or both.</p>
<div class="cell">
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">import</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>ACC <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">ACC</span> <span class="op">==</span> <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">RT</span> <span class="op">&lt;=</span> <span class="fl">500</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The arguments for the first <code><a href="https://rdrr.io/r/base/ifelse.html">ifelse()</a></code> are as follows: Accuracy is equal to 1. If TRUE, then second <code><a href="https://rdrr.io/r/base/ifelse.html">ifelse()</a></code> statement. If FALSE, then 0.</p>
<p>This makes sense because if the accuracy is <code>0</code> (incorrect), then the value needs to remain <code>0</code>. However, if the accuracy is <code>1</code>, the value will depend on whether the reaction time is less than <code>500</code> (thus the second <code><a href="https://rdrr.io/r/base/ifelse.html">ifelse()</a></code>).</p>
<p>If accuracy is equal to <code>1</code>, then if reaction time is less than or equal to <code>500</code>, then set accuracy to <code>1</code>. If FALSE, then set accuracy to <code>0</code>.</p>
<p><em>Know that you can place the additional <code><a href="https://rdrr.io/r/base/ifelse.html">ifelse()</a></code> statement in either the TRUE or FALSE argument and can keep iterating on <code><a href="https://rdrr.io/r/base/ifelse.html">ifelse()</a></code> statements for as long as you need (however that can get pretty complicated).</em></p>
<p><code><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when()</a></code> is an alternative to an <code><a href="https://rdrr.io/r/base/ifelse.html">ifelse()</a></code>. Anytime you need multiple <code><a href="https://rdrr.io/r/base/ifelse.html">ifelse()</a></code> statements <code><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when()</a></code> tends to simplify the code and logic involved.</p>
<p>Let’s see examples of the two examples provided for <code><a href="https://rdrr.io/r/base/ifelse.html">ifelse()</a></code> as a comparison.</p>
<div class="cell">
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">import</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Met_ResponseDeadline <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span><span class="va">RT</span> <span class="op">&lt;=</span> <span class="fl">500</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>                                          <span class="va">RT</span> <span class="op">&gt;</span> <span class="fl">500</span> <span class="op">~</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Notice that the notation is quite different here. Each argument contains the format: conditional statement followed by the symbol <code>~</code> (this should be read as “then set as”) and then a value to be assigned <strong>when</strong> the conditional statement is <code>TRUE</code>. There is no value to specify <strong>when</strong> it is <code>FALSE</code>.</p>
<p>Therefore, it is important when using the <code><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when()</a></code> function to either 1) include enough TRUE statement arguments to cover ALL possible values or 2) use the uncharacteristically non-intuitive notation - <code>TRUE ~ "some value"</code>. In the example above, all possible <code>RT</code> values are included in the two arguments <code>RT &lt;= 500</code> and <code>RT &gt; 500</code>.</p>
<p>To provide an example of the second option:</p>
<div class="cell">
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">import</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Met_ResponseDeadline <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span><span class="va">RT</span> <span class="op">&lt;=</span> <span class="fl">500</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>                                          <span class="cn">TRUE</span> <span class="op">~</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <code><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when()</a></code> function will evaluate each argument in sequential order. So when it gets to the last argument (and this should always be the last argument), this is basically saying, <strong>when</strong> it is <code>TRUE</code> that none of the above arguments were <code>TRUE</code> (hence why this argument is being evaluated) then (<code>~</code>) set the value to “some value” (whatever value you want to specify).</p>
<p>Now this function gets a little more complicated if you want to set values to <code>NA</code>. <code>NA</code> values are technically logical values like <code>TRUE</code> or <code>FALSE</code>. The values in a column can only be of one type; numerical, character, logical, etc. Therefore, if you have numerical values in a column but want to set some to <code>NA</code>, then this becomes an issue when using <code><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when()</a></code> (hopefully this will be fixed in future updates to <code>dplyr</code>). For now, how to get around this is changing the type of value that <code>NA</code> is. For instance; <code>as.numeric(NA)</code>, <code>as.character(NA)</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">import</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Met_ResponseDeadline <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span><span class="va">RT</span> <span class="op">&lt;=</span> <span class="fl">500</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>                                          <span class="va">RT</span> <span class="op">&gt;</span> <span class="fl">500</span> <span class="op">~</span> <span class="fl">0</span>,</span>
<span>                                          <span class="cn">TRUE</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="cn">NA</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now on to the example in which we used two <code><a href="https://rdrr.io/r/base/ifelse.html">ifelse()</a></code> statements.</p>
<div class="cell">
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">import</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>ACC <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span><span class="va">ACC</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">&amp;</span> <span class="va">RT</span> <span class="op">&lt;=</span> <span class="fl">500</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>                         <span class="va">ACC</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">&amp;</span> <span class="va">RT</span> <span class="op">&gt;</span> <span class="fl">500</span> <span class="op">~</span> <span class="fl">0</span>,</span>
<span>                         <span class="va">ACC</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">~</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>When you have multiple <code><a href="https://rdrr.io/r/base/ifelse.html">ifelse()</a></code> statements <code><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when()</a></code> becomes easier to read. Compare this use of <code><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when()</a></code> with the equivalent <code><a href="https://rdrr.io/r/base/ifelse.html">ifelse()</a></code> above.</p>
<p>The <code><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when()</a></code> function makes it very explicit what is happening. There are three conditional statements, therefore three categories of responses.</p>
<ol type="1">
<li><p>A correct response and reaction time that meets the deadline.</p></li>
<li><p>A correct response and reaction time that DOES NOT meet the deadline.</p></li>
<li><p>An incorrect response</p></li>
</ol>
<p>These three options cover all possible combinations between the the two columns <code>ACC</code> and <code>RT</code>.</p>
<p>Accuracy should only be set to <code>1</code> (correct) with the first option and that is made quite clearly because it is the only one with <code>~ 1</code>.</p>
<p>This is not as obvious in the <code><a href="https://rdrr.io/r/base/ifelse.html">ifelse()</a></code> example.</p>
<p>Let’s move on to the next <code>dplyr</code> function.</p>
</section><section id="group_by" class="level2"><h2 class="anchored" data-anchor-id="group_by">group_by()</h2>
<p>This function is very handy if we want to perform functions separately on different groups or splits of the data frame. For instance, maybe instead of calculating an overall “grand” mean we want to calculate a “grand” mean for each Subject separately. Instead of manually breaking the data frame up by Subject, the <code><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by()</a></code> function does this automatically in the background. Like this…</p>
<div class="cell">
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">Subject</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>RT <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">RT</span> <span class="op">&lt;</span> <span class="fl">200</span>, <span class="cn">NA</span>, <span class="va">RT</span><span class="op">)</span>,</span>
<span>         grandRT <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">RT</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>         RTdiff <span class="op">=</span> <span class="va">RT</span> <span class="op">-</span> <span class="va">grandRT</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Caution
</div>
</div>
<div class="callout-body-container callout-body">
<p>I suggest exercising caution when using <code><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by()</a></code> because the grouping will be maintained until you specify a different <code><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by()</a></code> or until you ungroup it using <code><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup()</a></code>. So I always like to <code><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup()</a></code> immediately after I am done with it.</p>
</div>
</div>
<p>You will now notice that each subject has a different <code>grandRT</code>, simply because we specified <code>group_by(data, Subject)</code>. Let’s say we want to do it not just grouped by Subject, but also Condition.</p>
<div class="cell">
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">Subject</span>, <span class="va">Condition</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>RT <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">RT</span> <span class="op">&lt;</span> <span class="fl">200</span>, <span class="cn">NA</span>, <span class="va">RT</span><span class="op">)</span>,</span>
<span>         grandRT <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">RT</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>         RTdiff <span class="op">=</span> <span class="va">RT</span> <span class="op">-</span> <span class="va">grandRT</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by()</a></code> does not only work on <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> - it will work on any other functions you specify after <code><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by()</a></code>. Therefore, it can essentially replace most uses of for loops.</p>
</section><section id="by-vs.-group_by" class="level2"><h2 class="anchored" data-anchor-id="by-vs.-group_by">.by vs.&nbsp;group_by()</h2>
<p>A new feature was recently introduced to replace some uses of <code><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by()</a></code>. You can use the argument <code>.by =</code> inside of <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> and <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise()</a></code> (and other functions) to avoid having to use <code><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup()</a></code>.</p>
<p><code>.by =</code> will only group the data frame for that one function and the returned output will be an ungrouped data frame. In general, I would suggest using <code>.by =</code> unless there is good reason to use <code><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by()</a></code>.</p>
<p>The above grouped mutate can be performed with <code>by =</code> like this:</p>
<div class="cell">
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>.by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">Subject</span>, <span class="va">Condition</span><span class="op">)</span>,</span>
<span>         RT <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">RT</span> <span class="op">&lt;</span> <span class="fl">200</span>, <span class="cn">NA</span>, <span class="va">RT</span><span class="op">)</span>,</span>
<span>         grandRT <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">RT</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>         RTdiff <span class="op">=</span> <span class="va">RT</span> <span class="op">-</span> <span class="va">grandRT</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You can see that <code>.by =</code> is also more concise (fewer lines of code) than <code><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by()</a></code></p>
</section><section id="sec-summarise" class="level2"><h2 class="anchored" data-anchor-id="sec-summarise">summarise()</h2>
<p>The <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise()</a></code> function will <strong>reduce</strong> a data frame by summarizing values in one or multiple columns. The values will be summarised on some statistical value, such as a mean, median, or standard deviation.</p>
<p>Remember that in order to calculate the <code>FlankerEffect</code> for each subject, we first need to calculate each subject’s mean <code>RT</code> on <code>incongruent</code> trials and their mean <code>RT</code> on <code>congruent</code> trials</p>
<p>We’ve done our filtering, selecting, mutating, now let’s aggregate RTs across <code>Condition</code> to calculate mean <code>RT</code>. We will use a combo of <code>.by =</code> and <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise()</a></code>. <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise()</a></code> is almost always used in conjunction with <code>.by =</code> or <code><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by()</a></code>.</p>
<p><em>Let’s also summarise the mean accuracy across conditions.</em></p>
<div class="cell">
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>.by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">Subject</span>, <span class="va">Condition</span><span class="op">)</span>,</span>
<span>            RT.mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">RT</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>            ACC.mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">ACC</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise()</a></code> you need to create new column names that will contain the aggregate values. <code>RT.mean</code> seems to make sense to me.</p>
<p>What does the resulting data frame look like? There should be three rows per subject, one for incongruent trials, one for congruent trials, and one for neutral trials. You can see that we now have mean RTs on all conditions for each subject.</p>
<p>Also, notice how non-grouped columns got removed: <code>Trial</code>, and <code>ACC</code>.</p>
</section><section id="sec-pivot_wider" class="level2"><h2 class="anchored" data-anchor-id="sec-pivot_wider">pivot_wider()</h2>
<p>Our data frame now looks like</p>
<div class="cell">
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">## # A tibble: 6 × 4</span></span>
<span><span class="co">##   Subject Condition   RT.mean ACC.mean</span></span>
<span><span class="co">##     &lt;dbl&gt; &lt;chr&gt;         &lt;dbl&gt;    &lt;dbl&gt;</span></span>
<span><span class="co">## 1   14000 incongruent    510.    0.574</span></span>
<span><span class="co">## 2   14000 congruent      401.    0.931</span></span>
<span><span class="co">## 3   14001 incongruent    423.    0.852</span></span>
<span><span class="co">## 4   14001 congruent      392.    0.980</span></span>
<span><span class="co">## 5   14002 congruent      462.    0.765</span></span>
<span><span class="co">## 6   14002 incongruent    536.    0.463</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Ultimately, we want to have one row per subject and to calculate the difference in mean RT between incongruent and congruent conditions. It is easier to calculate the difference between two values when they are in the same row. Currently, the mean RT for each condition is on a different row. What we need to do is <strong>reshape</strong> the data frame. To do so we will use the <code><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider()</a></code> function from the <code>tidyr</code> package.</p>
<p>The <code>tidyr</code> package, like <code>readr</code> and <code>dplyr</code>, is from the <strong>tidyverse</strong> set of packages. The <code><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider()</a></code> function will convert a long data frame to a wide data frame. In other words, it will spread values on different rows across different columns.</p>
<p>In our example, what we want to do is <code><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider()</a></code> the mean RT values for the two conditions across different columns. So we will end up with is one row per subject and one column for each condition. Rather than incongruent, and congruent trials being represented down rows we are spreading them across columns (widening the data frame).</p>
<p>The three main arguments to specify in <code><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider()</a></code> are</p>
<ul>
<li><p><strong>id_cols</strong>: The column names that uniquely identifies (e.g.&nbsp;“Subject”) each observation and that you want to be retained when <strong>reshaping</strong> the data frame.</p></li>
<li><p><strong>names_from</strong>: The column name that contains the variables to create new columns by (e.g.&nbsp;“Condition”). The values in this column will become Column names in the wider data format</p></li>
<li><p><strong>values_from</strong>: The column name that contains the values (e.g.&nbsp;“RT”).</p></li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data_wide</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span><span class="op">(</span>id_cols <span class="op">=</span> <span class="st">"Subject"</span>,</span>
<span>              names_from <span class="op">=</span> <span class="st">"Condition"</span>, </span>
<span>              values_from <span class="op">=</span> <span class="st">"RT.mean"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now our data frame looks like</p>
<div class="cell">
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">data_wide</span><span class="op">)</span></span>
<span><span class="co">## # A tibble: 6 × 3</span></span>
<span><span class="co">##   Subject incongruent congruent</span></span>
<span><span class="co">##     &lt;dbl&gt;       &lt;dbl&gt;     &lt;dbl&gt;</span></span>
<span><span class="co">## 1   14000        510.      401.</span></span>
<span><span class="co">## 2   14001        423.      392.</span></span>
<span><span class="co">## 3   14002        536.      462.</span></span>
<span><span class="co">## 4   14003        679.      567.</span></span>
<span><span class="co">## 5   14004        655.      548.</span></span>
<span><span class="co">## 6   14005        559.      472.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Notice that the ACC.mean column and values were dropped. To add more transparency to our data frame it would be a good idea to label what values the “congruent” and “incongruent” columns contain. You can do this with the optional <code>names_prefix</code> argument. For instance:</p>
<div class="cell">
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data_wide</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span><span class="op">(</span>id_cols <span class="op">=</span> <span class="st">"Subject"</span>,</span>
<span>              names_from <span class="op">=</span> <span class="st">"Condition"</span>, </span>
<span>              values_from <span class="op">=</span> <span class="st">"RT.mean"</span>,</span>
<span>              names_prefix <span class="op">=</span> <span class="st">"RT_"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">data_wide</span><span class="op">)</span></span>
<span><span class="co">## # A tibble: 6 × 3</span></span>
<span><span class="co">##   Subject RT_incongruent RT_congruent</span></span>
<span><span class="co">##     &lt;dbl&gt;          &lt;dbl&gt;        &lt;dbl&gt;</span></span>
<span><span class="co">## 1   14000           510.         401.</span></span>
<span><span class="co">## 2   14001           423.         392.</span></span>
<span><span class="co">## 3   14002           536.         462.</span></span>
<span><span class="co">## 4   14003           679.         567.</span></span>
<span><span class="co">## 5   14004           655.         548.</span></span>
<span><span class="co">## 6   14005           559.         472.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now a stranger (or a future YOU) will be able to look at this data frame and immediately know that reaction time values are contained in these columns.</p>
<p>From here it is pretty easy, we just need to create a new column that is the difference between incongruent and congruent columns. We can use the <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> function to do this</p>
<div class="cell">
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data_wide</span> <span class="op">&lt;-</span> <span class="va">data_wide</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>FlankerEffect_RT <span class="op">=</span> <span class="va">RT_incongruent</span> <span class="op">-</span> <span class="va">RT_congruent</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">data_wide</span><span class="op">)</span></span>
<span><span class="co">## # A tibble: 6 × 4</span></span>
<span><span class="co">##   Subject RT_incongruent RT_congruent FlankerEffect_RT</span></span>
<span><span class="co">##     &lt;dbl&gt;          &lt;dbl&gt;        &lt;dbl&gt;            &lt;dbl&gt;</span></span>
<span><span class="co">## 1   14000           510.         401.            109. </span></span>
<span><span class="co">## 2   14001           423.         392.             31.3</span></span>
<span><span class="co">## 3   14002           536.         462.             74.0</span></span>
<span><span class="co">## 4   14003           679.         567.            113. </span></span>
<span><span class="co">## 5   14004           655.         548.            107. </span></span>
<span><span class="co">## 6   14005           559.         472.             87.1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Perfect! Using the <code>readr</code>, <code>dplyr</code>, and <code>tidyr</code> packages we have gone from a “tidy” raw data file to a data frame with one row per subject and a column of FlankerEffect scores.</p>
<p>What if we have multiple columns we want to get <strong>id_cols</strong>, <strong>names_from</strong>, or <strong>values_from</strong>? <code><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider()</a></code> allows for this very easily. For instance:</p>
<div class="cell">
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data_wide</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span><span class="op">(</span>id_cols <span class="op">=</span> <span class="st">"Subject"</span>,</span>
<span>              names_from <span class="op">=</span> <span class="st">"Condition"</span>, </span>
<span>              values_from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"RT.mean"</span>, <span class="st">"ACC.mean"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">data_wide</span><span class="op">)</span></span>
<span><span class="co">## # A tibble: 6 × 5</span></span>
<span><span class="co">##   Subject RT.mean_incongruent RT.mean_congruent ACC.mean_incongruent</span></span>
<span><span class="co">##     &lt;dbl&gt;               &lt;dbl&gt;             &lt;dbl&gt;                &lt;dbl&gt;</span></span>
<span><span class="co">## 1   14000                510.              401.               0.574 </span></span>
<span><span class="co">## 2   14001                423.              392.               0.852 </span></span>
<span><span class="co">## 3   14002                536.              462.               0.463 </span></span>
<span><span class="co">## 4   14003                679.              567.               0.0926</span></span>
<span><span class="co">## 5   14004                655.              548.               0.0370</span></span>
<span><span class="co">## 6   14005                559.              472.               0.204 </span></span>
<span><span class="co">## # ℹ 1 more variable: ACC.mean_congruent &lt;dbl&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now you can see that we have four columns corresponding to reaction times and accuracy values across the two conditions. You can use the same notation <code><a href="https://rdrr.io/r/base/c.html">c()</a></code> if you want to use multiple column for <strong>id_cols</strong>, <strong>names_from</strong>, <strong>values_from</strong>.</p>
<p>Now we can calculate a FlankerEffect for both RT and Accuracy values</p>
<div class="cell">
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data_wide</span> <span class="op">&lt;-</span> <span class="va">data_wide</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>FlankerEffect_RT <span class="op">=</span> <span class="va">RT.mean_incongruent</span> <span class="op">-</span> <span class="va">RT.mean_congruent</span>,</span>
<span>         FlankerEffect_ACC <span class="op">=</span> <span class="va">ACC.mean_incongruent</span> <span class="op">-</span> <span class="va">ACC.mean_congruent</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="sec-pivot_longer" class="level2"><h2 class="anchored" data-anchor-id="sec-pivot_longer">pivot_longer()</h2>
<p>For our goal with this data set, we do not need to switch back to a <strong>longer</strong> data format, however <strong>reshaping</strong> your data to a <strong>longer</strong> format may be something you want to do one day.</p>
<p>Let’s try to reshape the <code>data_wide</code> back to a long format that we originally started with.</p>
<p>When you have multiple <strong>value</strong> columns this is not as intuitive as <code><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider()</a></code>. To see more documentation and examples use <code>?tidyr::pivot_longer()</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data_long</span> <span class="op">&lt;-</span> <span class="va">data_wide</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">contains</a></span><span class="op">(</span><span class="st">"mean"</span><span class="op">)</span>,</span>
<span>               names_to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">".value"</span>, <span class="st">"Condition"</span><span class="op">)</span>,</span>
<span>               names_sep <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="all-together-now" class="level2"><h2 class="anchored" data-anchor-id="all-together-now">All Together Now</h2>
<p>We can pipe the relevant functions in the chapter together as such</p>
<div class="cell">
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## Setup</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://readr.tidyverse.org">readr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org">tidyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Import</span></span>
<span><span class="va">import</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"data/tidyverse_example.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Score</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">import</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>Accuracy <span class="op">=</span> <span class="va">ACC</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">TrialProc</span> <span class="op">==</span> <span class="st">"real"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">Subject</span>, <span class="va">Condition</span>, <span class="va">RT</span>, <span class="va">Trial</span>, ACC <span class="op">=</span> <span class="va">Accuracy</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">Subject</span>, <span class="va">Condition</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>RT <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">RT</span> <span class="op">&lt;</span> <span class="fl">200</span>, <span class="cn">NA</span>, <span class="va">RT</span><span class="op">)</span>,</span>
<span>         grandRT <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">RT</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>         RTdiff <span class="op">=</span> <span class="va">RT</span> <span class="op">-</span> <span class="va">grandRT</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>RT.mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">RT</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>            ACC.mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">ACC</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span><span class="op">(</span>id_cols <span class="op">=</span> <span class="st">"Subject"</span>,</span>
<span>              names_from <span class="op">=</span> <span class="st">"Condition"</span>, </span>
<span>              values_from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"RT.mean"</span>, <span class="st">"ACC.mean"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>FlankerEffect_RT <span class="op">=</span> <span class="va">RT.mean_incongruent</span> <span class="op">-</span> <span class="va">RT.mean_congruent</span>,</span>
<span>         FlankerEffect_ACC <span class="op">=</span> <span class="va">ACC.mean_incongruent</span> <span class="op">-</span> <span class="va">ACC.mean_congruent</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p>Virtually all the R scripts you write will require the <code>dplyr</code> package. The more you know what it can do, the easier it will be for you to write R Scripts. I highly suggest checking out these introductions to <code>dplyr</code>.</p>
<p><a href="https://dplyr.tidyverse.org" class="uri">https://dplyr.tidyverse.org</a> <a href="https://cran.r-project.org/web/packages/dplyr/vignettes/dplyr.html" class="uri">https://cran.r-project.org/web/packages/dplyr/vignettes/dplyr.html</a></p>


</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./import-write.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Import and Export Data</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./data-processing-steps.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Data Processing Steps</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>